<ion-view>

    <ion-nav-bar class="nav-title-slide-ios7 bar-light">

        <ion-nav-back-button class="button-clear"><i class="icon ion-ios7-arrow-back"></i></ion-nav-back-button>

        <ion-nav-buttons side="left">
            <button menu-toggle="left" class="button button-icon button-clear ion-navicon"></button>
        </ion-nav-buttons>

    </ion-nav-bar>

    <ion-content>

        <ion-list>
            <div ng-repeat="device in installation.devices">
                <ion-item class=" item-icon-right"
                          style="border-width: 1px; border-style: dotted;"
                          ng-click="toggleDevice(device.id)">
                    <label>
                        <i class="icon-item ion-cube"
                           ng-style="device.id == activeStream.deviceid && {'color': 'rgb(129, 207, 98)' } || {'color': 'rgb(82, 154, 233)'} ">
                        </i>
                        {{device.name}}
                    </label>
                    <i class="icon ion-wifi"
                       style="font-size: 24px; right: 32px;"
                       ng-click="showData(device.id, 'online')"
                       ng-style="datastreams[device.id + 'online'].id == 'online' && datastreams[device.id + 'online'].current_value == '0' && {'color': 'rgb(253, 57, 80)'} || {'color': 'rgb(129, 207, 98)'}">
                    </i>
                    <ion-option-button class="button-assertive">Alarms</ion-option-button>
                    <ion-option-button class="button-positive">Controls</ion-option-button>
                </ion-item>

                <ion-item class="item-icon-right"
                          style="padding-left: 14px; border-width: 1px; border-style: dotted;"
                          ng-repeat="readings in datastreams | datastreamFilter:device.id | filter:{ id: '!online' }| orderObjectBy:'name':'reverse'"
                          ng-click="showData(readings.deviceid, readings.id)"
                          ng-show="isDeviceShown(device.id)">
                    <label>
                        <i class="icon-item ion-load-d"
                           ng-hide="readings.ctrlType == 'data' && (readings.id != activeStream.id || readings.deviceid != activeStream.deviceid || !showChart)"
                           style="color: rgb(82, 154, 233);">
                        </i>
                        <i class="icon-item ion-ios7-speedometer"
                           ng-show="readings.ctrlType == 'data' && (readings.id != activeStream.id || readings.deviceid != activeStream.deviceid || !showChart)"
                           ng-style="device.id == activeStream.deviceid && {'color': 'rgb(129, 207, 98)'} || {'color': 'rgb(82, 154, 233)'}">
                        </i>
                        {{readings.name}}
                    </label>
                    <span class="badge badge-balanced">
                            {{readings.current_value}} {{readings.unit.symbol}}
                    </span>
                    <ion-option-button class="button-assertive">Alarms</ion-option-button>
                    <ion-option-button class="button-positive" ng-click="controlDetails(device.id, readings.id)">
                        Details
                    </ion-option-button>

                </ion-item>
            </div>

            <label class="item item-input item-icon-left item-select"
                   style="background-color: #f5f5f5;"
                   ng-show="activeStream">

                <i class="ion-ios7-clock-outline">
                    {{datastreams[activeStream.deviceid + activeStream.id].name}}
                    {{datastreams[activeStream.deviceid +
                    activeStream.id].current_value}}{{datastreams[activeStream.deviceid + activeStream.id].unit.symbol}}
                </i>

                <select style="background:none; padding: 7px 48px 16px 16px;"
                        ng-options="t.text group by t.type for t in timescale"
                        ng-model="timeScale"
                        ng-change="selectAction(timeScale, activeStream.deviceid, activeStream.id)">
                </select>

            </label>

            <div id="chartContainer" style="height: 200px"
                 dx-chart="{bindingOptions: {dataSource: 'chartSettings.dataSource',
                                         argumentAxis: 'chartSettings.argumentAxis',
                                         series: 'chartSettings.series'
                                        },
                                         valueAxis: chartSettings.valueAxis,
                                         legend: chartSettings.legend,
                                         tooltip: chartSettings.tooltip,
                                         crosshair: chartSettings.crosshair,
                                         loadingIndicator: chartSettings.loadingIndicator
                        }"
                 ng-show="chartSettings.dataSource.length">
            </div>
        </ion-list>
    </ion-content>
</ion-view>