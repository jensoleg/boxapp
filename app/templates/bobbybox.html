<ion-view>

    <ion-nav-bar class="nav-title-slide-ios7 bar-light">

        <ion-nav-back-button class="button-clear"><i class="icon ion-ios7-arrow-back"></i></ion-nav-back-button>

        <ion-nav-buttons side="left">
            <button menu-toggle="left" class="button button-icon button-clear ion-navicon"></button>
        </ion-nav-buttons>

    </ion-nav-bar>

    <ion-content>

        <ion-list>
            <div ng-repeat="device in installation.devices">
                <ion-item class=" item-icon-right"
                          style="border-width: 1px;"
                          ng-click="toggleDevice(device.id)">
                    <label>
                        <i class="icon-item ion-cube"
                           style="vertical-align: middle;font-size: 140%;"
                           ng-style="device.id == activeStream.deviceid && {'color': 'rgb(129, 207, 98)' } || {'color': 'rgb(82, 154, 233)'} ">
                        </i>
                        {{device.name}} {{device.placement}}
                    </label>
                    <i class="icon ion-wifi"
                       style="font-size: 24px; right: 32px;"
                       ng-click="showData(device.id, 'online')"
                       ng-style="datastreams[device.id + 'online'].id == 'online' && datastreams[device.id + 'online'].current_value == '0' && {'color': 'rgb(253, 57, 80)'} || {'color': 'rgb(129, 207, 98)'}">
                    </i>
                    <ion-option-button class="button-assertive">Alarms</ion-option-button>
                    <ion-option-button class="button-positive">Timers</ion-option-button>
                </ion-item>

                <ion-item class="item-icon-right"
                          style="padding-left: 14px; border-width: 1px;"
                          ng-class="{'selected' : readings.id == activeStream.id && device.id == activeStream.deviceid}"
                          ng-repeat="readings in datastreams | datastreamFilter:device.id | filter:{ id: '!online' }| orderObjectBy:'name':'reverse'"
                          ng-click="showData(readings.deviceid, readings.id)"
                          ng-show="isDeviceShown(device.id)">
                    <label>
                        <i class="icon-item ion-load-d"
                           style="vertical-align: middle;font-size: 140%; color: rgb(82, 154, 233);"
                           ng-hide="readings.ctrlType == 'data' && (readings.id != activeStream.id || readings.deviceid != activeStream.deviceid || !showChart)">
                        </i>
                        <i class="icon-item ion-ios7-speedometer"
                           style="vertical-align: middle;font-size: 140%;"
                           ng-show="readings.ctrlType == 'data' && (readings.id != activeStream.id || readings.deviceid != activeStream.deviceid || !showChart)"
                           ng-style="readings.id == activeStream.id && device.id == activeStream.deviceid && {'color': 'rgb(129, 207, 98)'} || {'color': 'rgb(82, 154, 233)'}">
                        </i>
                        {{readings.name}}
                    </label>
                    <span class="badge badge-balanced">
                            {{readings.current_value}} {{readings.unit.symbol}}{{readings.unit.units}}
                    </span>
                    <ion-option-button class="button-assertive">Alarms</ion-option-button>
                    <ion-option-button class="button-positive" ng-click="controlDetails(device.id, readings.id)">
                        Details
                    </ion-option-button>

                </ion-item>
            </div>

            <ion-item class="item item-icon-right"
                      style="background-color:#EEEEEE;"
                      ng-show="activeStream  && chartSettings.dataSource.length">

                <label>
                    {{datastreams[activeStream.deviceid + activeStream.id].name}}
                    {{datastreams[activeStream.deviceid +
                    activeStream.id].current_value}}{{datastreams[activeStream.deviceid + activeStream.id].unit.symbol}}
                </label>

                <span style="position: absolute;right: 30px;">{{timeScale.text}}</span>

                <i class="icon ion-ios7-clock-outline">
                    <select style="background:none;opacity:0"
                            ng-options="t.text group by t.type for t in timescale"
                            ng-model="timeScale"
                            ng-change="selectAction(timeScale, activeStream.deviceid, activeStream.id)">
                    </select>
                </i>

            </ion-item>

            <ion-item ng-show="activeStream"
                      style="border-width: 0px;">
                <div id="chartContainer" style="height: 300px"
                     dx-chart="{bindingOptions: {dataSource: 'chartSettings.dataSource',
                                         argumentAxis: 'chartSettings.argumentAxis',
                                         series: 'chartSettings.series'
                                        },
                                         valueAxis: chartSettings.valueAxis,
                                         legend: chartSettings.legend,
                                         tooltip: chartSettings.tooltip,
                                         crosshair: chartSettings.crosshair,
                                         palette: chartSettings.palette,
                                         commonAxisSettings: chartSettings.commonAxisSettings,
                                         commonPaneSettings: chartSettings.commonPaneSettings,
                                         animation: chartSettings.animation,
                                         loadingIndicator: chartSettings.loadingIndicator
                        }"
                     ng-show="chartSettings.dataSource.length">
                </div>
            </ion-item>
        </ion-list>
    </ion-content>
</ion-view>