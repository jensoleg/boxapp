<div id="forecast" class="weather-box">
    <ion-list>
        <div ng-repeat="device in installation.devices">
            <div class="row">
                <div class="col">
                    <label>{{device.name}}</label>
                </div>
                <div class="col-icon col">
                    <i class="col-icon-font icon ion-cube"
                       ng-click="toggleDevice(device.id)"
                       ng-style="device.id == activeStream.deviceid && {'color': '#4a87ee'} || {'color': 'white'}">
                    </i>
                </div>
                <div class="col">
                    <i class="col-icon-font icon ion-wifi"
                       ng-click="showData(device.id, 'online')"
                       ng-style="datastreams[device.id + 'online'].id == 'online' && datastreams[device.id + 'online'].current_value == '0' && {'color': 'rgb(216, 90, 95)'} || {'color': 'rgb(113, 221, 71)'}">
                    </i>

                </div>
            </div>
            <div class="row item-accordion" style="margin-top: 0"
                 ng-repeat="readings in datastreams | datastreamFilter:device.id | filter:{ id: '!online' }| orderObjectBy:'name':'reverse'"
                 ng-show="isDeviceShown(device.id)">
                <div class="col">
                    <label>{{readings.name}}</label>
                </div>
                <div class="col-icon col">
                    <i class="col-icon-font icon ion-ios7-gear"
                       ng-hide="readings.ctrlType == 'data' && (readings.id != activeStream.id || readings.deviceid != activeStream.deviceid || !loadXively)"
                       style="color: #4a87ee">
                    </i>
                    <i class="col-icon-font icon ion-arrow-graph-up-right"
                       ng-show="readings.ctrlType == 'data' && (readings.id != activeStream.id || readings.deviceid != activeStream.deviceid || !loadXively)"
                       ng-click="showData(readings.deviceid, readings.id)"
                       ng-style="readings.id == activeStream.id && readings.deviceid == activeStream.deviceid && {'color': '#4a87ee'} || {'color': 'white'}">
                    </i>
                </div>
                <!--
                                    <i class="col-icon-font icon ion-ios7-gear "
                                       ng-show="readings.ctrlType == 'ctrlValue' && !readings.isSelecting"
                                       ng-click="showValueCtrl(readings.deviceid, readings.id)">
                                    </i>

                                    <div ng-show="readings.isSelecting && readings.ctrlType=='ctrlValue'"
                                         class="range range-positive range-select-input">
                                        <input type="range"
                                               class="domain-input"
                                               min="{{readings.minDomain}}"
                                               max="{{readings.maxDomain}}"
                                               value="readings.newValue"
                                               ng-model="readings.newValue">
                                    </div>
                                    <i class="col-icon-font icon ion-ios7-clock"
                                       ng-show="readings.ctrlType == 'ctrlTimeValue' && !readings.isSelecting"
                                       ng-click="showValueCtrl(readings.deviceid, readings.id)">
                                    </i>

                                    <div ng-show="readings.ctrlType == 'ctrlTimeValue' && readings.isSelecting">
                                        <span class="checkbox-ctrls">
                                        <i ng-click="closeValueCtrl(readings.deviceid, readings.id)"
                                           class="icon ion-close-circled checkbox-close">
                                        </i>
                                        <i ng-click="setValueCtrl(readings.deviceid, readings.id)"
                                           class="icon ion-checkmark-circled checkbox-set">
                                        </i>
                                        </span>
                                    </div>

                                    <div ng-show="readings.ctrlType == 'ctrlSwitch'">
                                        <label class="checkbox checkbox-label">
                                            <input
                                                    type="checkbox"
                                                    class="checkbox-size"
                                                    ng-model="readings.current_value"
                                                    ng-true-value="1"
                                                    ng-false-value="0"
                                                    ng-change="toggleCtrlSwitch(readings.deviceid, readings.id)">
                                        </label>
                                    </div>
                                </div>
                -->
                <div class="col">
                    <div ng-show="readings.ctrlType == 'data'">
                        <div ng-class="{ critical: readings.triggered}">
                            <span class="temp-high">{{readings.current_value}}{{readings.unit.symbol}}</span>
                        </div>
                    </div>
                    <!--
                                        <div ng-show="readings.ctrlType == 'ctrlValue'">
                                            <div ng-show="readings.isSelecting">
                                            <span class="checkbox-ctrls">
                                            <i ng-click="closeValueCtrl(readings.device.id, readings.id)"
                                               class="icon ion-close-circled checkbox-close">
                                            </i>
                                            <i ng-click="setValueCtrl(readings.device.id, readings.id)"
                                               class="icon ion-checkmark-circled checkbox-set">
                                            </i>
                                            </span>
                                            <span class="temp-high value-display">
                                                {{readings.newValue}}
                                            </span>
                                            </div>
                                    <span ng-hide="readings.isSelecting"
                                          class="temp-high">
                                        {{readings.newValue}}{{readings.unit.symbol}}
                                    </span>
                                        </div>
                                        <div ng-show="readings.ctrlType == 'ctrlTimeValue'">
                                            <div ng-show="readings.isSelecting">
                                                <input class="custom replaced" ng-model="readings.newValue"
                                                       ng-value="readings.newValue" type="time" step="60" focus-on="input-time">
                                            </div>
                                    <span ng-hide="readings.isSelecting"
                                          class="temp-high">
                                        {{readings.current_value}}{{readings.unit.symbol}}
                                    </span>

                                    </div>
                -->
                </div>
            </div>
        </div>
    </ion-list>

    <div ng-show="activeStreamReady" style="padding-top: 10px;">
        <h4 class="title">
            <div class="row" style="border-bottom: 0px">
                <div class="col col-50">
                    {{datastreams[activeStream.deviceid + activeStream.id].name}}
                    {{datastreams[activeStream.deviceid +
                    activeStream.id].current_value}}{{datastreams[activeStream.deviceid + activeStream.id].unit.symbol}}
                </div>
                <div class="col ui-select">
                    <div class="custom-select-container">
                        <select class="custom replaced"
                                ng-options="t.text group by t.type for t in timescale"
                                ng-model="timeScale"
                                ng-change="selectAction(timeScale)">
                        </select>
                        <span class="custom-select" aria-hidden="true">
                               <span>{{timeScale.text}}</span>
                        </span>
                    </div>
                </div>
            </div>
        </h4>
    </div>

    <div id="chartContainer" style="height: 200px"
         dx-chart="{bindingOptions: {dataSource: 'chartSettings.dataSource',
                                         argumentAxis: 'chartSettings.argumentAxis',
                                         series: 'chartSettings.series'
                                        },
                                         valueAxis: chartSettings.valueAxis,
                                         legend: chartSettings.legend,
                                         tooltip: chartSettings.tooltip,
                                         crosshair: chartSettings.crosshair,
                                         loadingIndicator: chartSettings.loadingIndicator
                        }"
         ng-show="chartData.length">

    </div>

    <div class="clearfix">
        <a href="http://bobbytechnologies.dk" onClick="javascript:return openExternal(this)">
            <div class="bobby-logo"></div>
        </a>
    </div>

</div>