<div id="forecast" class="weather-box">
    <div ng-show="activeStreamReady">
        <h4 class="title">
            <div class="row" style="border-bottom: 0px">
                <div class="col col-50">
                    {{datastreams[activeStream.id].name}}
                    {{datastreams[activeStream.id].current_value}}{{datastreams[activeStream.id].unit.symbol}}
                </div>
                <!--div class="col ui-select">
                    <div class="custom-select-container">
                        <select class="custom replaced"
                                ng-options="device.name for device in devices"
                                ng-model="device"
                                ng-change="selectDevice(device.id)">
                        </select>
                        <span class="custom-select" aria-hidden="true">
                               <span>{{device.name}}</span>
                        </span>
                    </div>
                </div-->
                <div class="col ui-select">
                    <div class="custom-select-container">
                        <select class="custom replaced"
                                ng-options="t.text group by t.type for t in timescale"
                                ng-model="timeScale"
                                ng-change="selectAction(timeScale)">
                        </select>
                        <span class="custom-select" aria-hidden="true">
                               <span>{{timeScale.text}}</span>
                        </span>
                    </div>
                </div>
            </div>
        </h4>
    </div>

    <div ng-show="chartData.length > 0">
        <ion-slide-box delegate-handle="charts" show-pager="false" id="readings-scroll">
            <ion-slide>
                <div id="chartContainer" style="height: 200px" dx-chart="{bindingOptions: {dataSource: 'chartSettings.dataSource',
                                                                       argumentAxis: 'chartSettings.argumentAxis'},
                                                        valueAxis: chartSettings.valueAxis,
                                                        legend: chartSettings.legend,
                                                        tooltip: chartSettings.tooltip,
                                                        series: chartSettings.series,
                                                        crosshair: chartSettings.crosshair,
                                                        loadingIndicator: chartSettings.loadingIndicator
                                                       }"></div>
            </ion-slide>
            <ion-slide>
                <div style="height: 200px" dx-circular-gauge="{tooltip: gaugeSettings.tooltip,
                                                               subvalueIndicator: gaugeSettings.subvalueIndicator,
                                                               bindingOptions: {scale: 'gaugeSettings.scale',
                                                                       value: 'gaugeSettings.value',
                                                                       rangeContainer: 'gaugeSettings.rangeContainer',
                                                                       subvalues : 'gaugeSettings.subvalues'}
                                                                       }"></div>
            </ion-slide>
        </ion-slide-box>
    </div>

    <div class="row" style="margin-top: 0"
         ng-repeat="readings in datastreams|orderObjectBy:'ctrlType':'reverse'">
        <div class="col">
            <label>{{readings.name}}</label>
        </div>
        <div class="col-icon col">
            <i class="col-icon-font icon ion-arrow-graph-up-right "
               ng-show="readings.ctrlType == 'data' && (readings.id != activeStream.id || !loadXively)"
               ng-click="showData(readings.id)"
               ng-style="readings.id == activeStream.id && {'color': '#4a87ee'} || {'color': 'white'}">
            </i>
            <i class="col-icon-font icon ion-loading-d"
               ng-show="readings.ctrlType == 'data' && loadXively && readings.id == activeStream.id"
               style="color: #4a87ee">
            </i>
            <i class="col-icon-font icon ion-ios7-gear "
               ng-show="readings.ctrlType == 'ctrlValue' && !readings.isSelecting"
               ng-click="showValueCtrl(readings.id)">
            </i>

            <div ng-show="readings.isSelecting && readings.ctrlType=='ctrlValue'"
                 class="range range-positive range-select-input">
                <input type="range"
                       class="domain-input"
                       min="{{readings.minDomain}}"
                       max="{{readings.maxDomain}}"
                       value="readings.newValue"
                       ng-model="readings.newValue">
            </div>
            <i class="col-icon-font icon ion-ios7-clock"
               ng-show="readings.ctrlType == 'ctrlTimeValue' && !readings.isSelecting"
               ng-click="showValueCtrl(readings.id)">
            </i>

            <div ng-show="readings.ctrlType == 'ctrlTimeValue' && readings.isSelecting">
                        <span class="checkbox-ctrls">
                        <i ng-click="closeValueCtrl(readings.id)"
                           class="icon ion-close-circled checkbox-close">
                        </i>
                        <i ng-click="setValueCtrl(readings.id)" class="icon ion-checkmark-circled checkbox-set">
                        </i>
                        </span>
            </div>

            <div ng-show="readings.ctrlType == 'ctrlSwitch'">
                <label class="checkbox checkbox-label">
                    <input
                            type="checkbox"
                            class="checkbox-size"
                            ng-model="readings.current_value"
                            ng-true-value="1"
                            ng-false-value="0"
                            ng-change="toggleCtrlSwitch(readings.id)">
                </label>
            </div>
        </div>
        <div class="col">
            <div ng-show="readings.ctrlType == 'data'">
                <div ng-class="{ critical: readings.triggered}">
                <span class="temp-high">{{readings.current_value}}{{readings.unit.symbol}}</span>
                </div>
            </div>
            <div ng-show="readings.ctrlType == 'ctrlValue'">
                <div ng-show="readings.isSelecting">
                        <span class="checkbox-ctrls">
                        <i ng-click="closeValueCtrl(readings.id)"
                           class="icon ion-close-circled checkbox-close">
                        </i>
                        <i ng-click="setValueCtrl(readings.id)" class="icon ion-checkmark-circled checkbox-set">
                        </i>
                        </span>
                        <span class="temp-high value-display">
                            {{readings.newValue}}
                        </span>
                </div>
                <span ng-hide="readings.isSelecting"
                      class="temp-high">
                    {{readings.newValue}}{{readings.unit.symbol}}
                </span>
            </div>
            <div ng-show="readings.ctrlType == 'ctrlTimeValue'">
                <div ng-show="readings.isSelecting">
                    <input class="custom replaced" ng-model="readings.newValue"
                           ng-value="readings.newValue" type="time" step="60" focus-on="input-time">
                </div>
                <span ng-hide="readings.isSelecting"
                      class="temp-high">
                    {{readings.current_value}}{{readings.unit.symbol}}
                </span>
            </div>

        </div>
    </div>
    <div class="clearfix">
        <a href="http://bobbytechnologies.dk" onClick="javascript:return openExternal(this)">
            <div class="bobby-logo"></div>
        </a>
    </div>

</div>